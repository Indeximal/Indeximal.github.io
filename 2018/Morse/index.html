<!doctype html>
<html lang="en">
    <head>
        <title>Simple Beep</title>
        <meta charset="utf-8">
        <script>
        	// create web audio api context
			var audioCtx = new (window.AudioContext || window.webkitAudioContext)();
			var oscillator;
			const beepUnit = 150;

			// https://stackoverflow.com/questions/879152/how-do-i-make-javascript-beep/13194087
			// https://developer.mozilla.org/en-US/docs/Web/API/OscillatorNode

			function beep(duration, freq=440) {
				startBeep(freq);
				window.setTimeout(stopBeep, duration)
			}

			playing = false;

			function startBeep(freq=440) {
				if (playing) { return; }
				playing = true;

				oscillator = audioCtx.createOscillator();

				oscillator.type = 'sine';
				oscillator.frequency.setValueAtTime(freq, audioCtx.currentTime); // value in hertz
				oscillator.connect(audioCtx.destination);
				oscillator.start();
			}

			function stopBeep() {
				oscillator.stop();
				playing = false;
			}

			window.onkeydown = function (e) {
				if (e.key == " ") {
					startBeep();
				} else if (e.key == ".") {
					beep(beepUnit);
				} else if (e.key == "-") {
					beep(beepUnit*3);
				} else if (e.key == "Enter") {
					beep(beepUnit, 880);
				}
			}
			window.onkeyup = function (e) {
				if (e.key == " " || e.key == "Escape") {
					stopBeep();
				}
			}

        </script>
    </head>

    <body>
    	<button onclick="beep(500);">Play</button>
    </body>

</html>

